<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Supertonic - Web Demo</title>
        <link rel="stylesheet" href="/style.css">
    </head>
    <body>
        <div class="container">
            <h1>üé§ Supertonic</h1>
            <p class="subtitle">Text-to-Speech with ONNX Runtime Web</p>

            <div id="statusBox" class="status-box">
                <div class="status-text-wrapper">
                    <div id="statusText">‚ÑπÔ∏è <strong>Loading models...</strong>
                        Please wait...</div>
                </div>
                <div id="backendBadge" class="backend-badge">WebAssembly</div>
            </div>

            <div class="main-content">
                <div class="left-panel">
                    <div class="section">
                        <div class="ref-audio-label">
                            <label>Voice Style:</label>
                            <span id="voiceStyleInfo" class="ref-audio-info">Loading...</span>
                        </div>

                        <select id="voiceStyleSelect" style="margin-bottom: 10px;">
                            <option value="./assets/voice_styles/M1.json">Male 1 (M1)</option>
                            <option value="./assets/voice_styles/M2.json">Male 2 (M2)</option>
                            <option value="./assets/voice_styles/F1.json">Female 1 (F1)</option>
                            <option value="./assets/voice_styles/F2.json">Female 2 (F2)</option>
                            <option value="custom">üìÇ Upload Custom Style (.json)</option>
                        </select>
    
                        <div id="customStyleContainer" class="hidden" style="margin-top: 5px;">
                            <label for="voiceStyleUpload" style="font-size: 0.9em; color: #666;">Select Voice Style JSON:</label>
                            <input type="file" id="voiceStyleUpload" accept=".json">
                        </div>

                        <button id="toggleMixerBtn" class="toggle-mixer-btn">Show Mixer & Editor</button>
                    </div>

                    <!-- MIXER PANEL (Hidden by default) -->
                    <div id="mixerPanel" class="mixer-panel hidden">
                        <div class="mixer-header">
                            <h3>Timbre Heatmap (Style TTL)</h3>
                            <button id="resetMixerBtn" class="mixer-btn secondary" style="width: auto;">Reset</button>
                        </div>

                        <div class="mixer-canvas-container">
                            <canvas id="mixerCanvas"></canvas>
                        </div>

                        <div class="mixer-controls">
                            <!-- Row 1: Geometric -->
                            <div class="mixer-row">
                                <button id="btnMirrorX" class="mixer-btn secondary">Mirror X</button>
                                <button id="btnMirrorY" class="mixer-btn secondary">Mirror Y</button>
                                <button id="btnInvert" class="mixer-btn secondary">Invert</button>
                                <button id="btnRandShift" class="mixer-btn secondary">Rand Shift</button>
                            </div>

                            <!-- Row 2: DSP -->
                            <div class="mixer-row">
                                <button id="btnSharpen" class="mixer-btn dsp">Sharpen</button>
                                <button id="btnQuantize" class="mixer-btn dsp">Quantize</button>
                                <button id="btnEcho" class="mixer-btn dsp">Echo</button>
                                <button id="btnTremolo" class="mixer-btn dsp">Tremolo</button>
                                <button id="btnJitter" class="mixer-btn dsp">Jitter</button>
                            </div>

                            <!-- Row 3: Scalar -->
                            <div class="mixer-row" style="align-items: center;">
                                <div class="mixer-input-group">
                                    <span>Add:</span>
                                    <input type="number" id="valAdd" value="0.05" step="0.01">
                                    <button id="btnAdd" class="mixer-btn secondary" style="min-width: 40px;">Go</button>
                                </div>
                                <div class="mixer-input-group">
                                    <span>Mul:</span>
                                    <input type="number" id="valMul" value="1.1" step="0.1">
                                    <button id="btnMul" class="mixer-btn secondary" style="min-width: 40px;">Go</button>
                                </div>
                            </div>

                            <!-- Row 4: Singing Presets -->
                            <div class="mixer-row" style="margin-top: 10px;">
                                <div style="width: 100%;">
                                    <label style="display: block; font-size: 0.85em; color: #666; margin-bottom: 5px;">Singing Mode Presets:</label>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px;">
                                        <button id="btnSingingVerse" class="mixer-btn singing-verse">üìñ Verse</button>
                                        <button id="btnSingingChorus" class="mixer-btn singing-chorus">üé§ Chorus</button>
                                        <button id="btnSingingBridge" class="mixer-btn singing-bridge">üåâ Bridge</button>
                                        <button id="btnSingingIntro" class="mixer-btn singing-intro">üé¨ Intro</button>
                                        <button id="btnSingingOutro" class="mixer-btn singing-outro">üé¨ Outro</button>
                                        <button id="btnSinging" class="mixer-btn singing">üéµ General</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="section">
                        <label for="text">Text to Synthesize:</label>
                        <textarea id="text"
                            placeholder="Enter the text you want to convert to speech...">This morning, I took a walk in the park, and the sound of the birds and the breeze was so pleasant that I stopped for a long time just to listen.</textarea>
                    </div>

                    <div class="params-grid">
                        <div class="section">
                            <label for="totalStep">Total Steps (higher = better
                                quality):</label>
                            <input type="number" id="totalStep" value="5"
                                min="1" max="50">
                        </div>
                        
                        <div class="section">
                            <label for="speed">Speed (0.9-1.5 recommended):</label>
                            <input type="number" id="speed" value="1.05"
                                min="0.5" max="2.0" step="0.05">
                        </div>

                        <div class="section">
                            <label for="pitchShift">Pitch Shift (semitones):</label>
                            <input type="number" id="pitchShift" value="0" min="-12" max="12" step="1">
                        </div>

                        <div class="section">
                            <label for="wordChunkSize">Words per Chunk (optional):</label>
                            <input type="number" id="wordChunkSize" placeholder="e.g., 2" min="1">
                        </div>

                    </div>

                    <button id="generateBtn">Generate Speech</button>

                    <div id="error" class="error"></div>
                </div>

                <div class="right-panel">
                    <div id="results" class="results">
                        <div class="results-placeholder">
                            <div class="results-placeholder-icon">üé§</div>
                            <p>Generated speech will appear here</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <script type="module" src="/main.js"></script>
    </body>
</html>
